---
title: "required degree"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Basic Setup
```{r}
library(tidyverse)
library(ggplot2)

source("./vectorizing_strings.R")
Jobs_list <- list.files(path = "./csv files", pattern = "*.csv", full.names = TRUE)
Jobs <- lapply(Jobs_list, read.delim, header = TRUE, sep = ',')

```


## Print tables about least required degree

```{r}

degree_level = c("不拘", "高中以下", "高中", "高中以上", "專科", "專科以上", "大學", "大學以上", "碩士", "碩士以上", "博士")

J <- Jobs %>% 
  lapply(get_least_degree) %>% 
  lapply(function(x){
    #x[] <- 
    return(data.frame(degree = x) %>% 
      count(degree) %>%
      mutate(total = sum(n)) %>%
      mutate(rate = n / total * 100) %>%
      arrange(factor(degree, levels = degree_level))
    )}) #%>%
  bind_rows()
J[[1]]$degree[6]
J

```